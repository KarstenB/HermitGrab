<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HermitGrab Docs - TOML Configuration</title>
    <link rel="icon" type="image/svg+xml" href="HermitGrab.svg">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0A0A0A;
            color: #E2E8F0;
        }
        .font-mono {
            font-family: 'JetBrains Mono', monospace;
        }
        .glass-pane {
            background: rgba(23, 23, 23, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .gradient-text {
            background: linear-gradient(to right, #38bdf8, #818cf8, #c084fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .docs-content h2 {
            font-size: 2.25rem;
            font-weight: 700;
            border-bottom: 1px solid #334155;
            padding-bottom: 0.5rem;
            margin-top: 2.5rem;
            margin-bottom: 1.5rem;
        }
        .docs-content h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .docs-content p, .docs-content li {
            color: #94a3b8;
            line-height: 1.75;
        }
        .docs-content a {
            color: #38bdf8;
            text-decoration: underline;
        }
        .docs-content code {
            font-family: 'JetBrains Mono', monospace;
            background-color: #1e293b;
            color: #e2e8f0;
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem;
            font-size: 0.9em;
        }
        .docs-content pre {
             background-color: #111827;
             border-radius: 0.5rem;
             border: 1px solid #334155;
             padding: 1rem;
             overflow-x: auto;
             margin-top: 1rem;
             margin-bottom: 1rem;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Header -->
    <header class="fixed top-0 left-0 right-0 z-50 glass-pane">
        <div class="container mx-auto px-6 py-3 flex justify-between items-center">
            <a href="index.html" class="flex items-center space-x-3">
                <img src="HermitGrab.svg" alt="HermitGrab Logo" class="w-10 h-10">
                <h1 class="text-2xl font-bold text-slate-100">HermitGrab</h1>
            </a>
            <nav class="hidden md:flex space-x-8 text-slate-300">
                <a href="index.html#features" class="hover:text-sky-400 transition-colors">Features</a>
                <a href="toml-docs.html" class="font-bold text-white">Docs</a>
                <a href="cli-docs.html" class="hover:text-sky-400 transition-colors">CLI Reference</a>
                <a href="index.html#install" class="hover:text-sky-400 transition-colors">Install</a>
            </nav>
            <a href="https://github.com/KarstenB/hermitgrab" target="_blank" class="hidden md:flex items-center space-x-2 bg-slate-800 hover:bg-slate-700 text-slate-200 px-4 py-2 rounded-lg transition-colors">
                <i data-lucide="github"></i>
                <span>GitHub</span>
            </a>
        </div>
    </header>

    <main class="pt-32 pb-20">
        <div class="container mx-auto px-6 max-w-4xl docs-content">
            <h1 class="text-5xl font-black tracking-tight gradient-text">hermit.toml Configuration</h1>
            <p class="mt-4 text-xl text-slate-400">A detailed reference for the `hermit.toml` file format.</p>

            <h2>Top-Level Keys</h2>
            <p>These keys are defined at the root of your `hermit.toml` file.</p>

            <h3><code>provides = [&lt;tags&gt;]</code></h3>
            <p>A list of tags that this configuration file provides. These tags can be used by other configurations in their `requires` list.</p>
            <pre><code>provides = ["fish", "fish-aliases"]</code></pre>

            <h3><code>requires = [&lt;conditions&gt;]</code></h3>
            <p>A list of conditions that must be met for this configuration file to be processed. If any condition is not met, the entire file is skipped.</p>
            <ul>
                <li><code>"+tag"</code>: The tag `tag` must be active.</li>
                <li><code>"-tag"</code>: The tag `tag` must NOT be active.</li>
                <li><code>"+key=value"</code>: A detected tag `key` must exist and have the value `value`.</li>
                <li><code>"-key=value"</code>: A detected tag `key` must NOT have the value `value`.</li>
            </ul>
            <pre><code># Only applies on Unix-like systems where the 'work' profile tag is active
requires = ["+os_family=unix", "+work"]</code></pre>

            <h2>Sections</h2>
            <p>Sections define the actions HermitGrab will take. Each section can have its own `requires` key for conditional execution.</p>

            <h3><code>[[file]]</code></h3>
            <p>Manages linking or copying files and directories.</p>
            <ul>
                <li><code>source</code>: (Required) The path to the source file, relative to the `hermit.toml` file.</li>
                <li><code>target</code>: (Required) The destination path. Tilde expansion (`~`) is supported.</li>
                <li><code>method</code>: (Optional) How to place the file. Can be `Link` (soft link, default), `HardLink`, or `Copy`.</li>
                <li><code>fallback</code>: (Optional) Action to take if the target file already exists. Can be `None` (default, fails), `Backup`, or `BackupOverwrite`.</li>
                <li><code>requires</code>: (Optional) A list of conditions for this specific file action.</li>
            </ul>
            <pre><code>[[file]]
source = "starship.toml"
target = "~/.config/starship.toml"
method = "Link"
fallback = "Backup"
requires = ["+starship"]</code></pre>

            <h3><code>[[patch]]</code></h3>
            <p>Atomically modifies an existing file.</p>
            <ul>
                <li><code>source</code>: (Required) The file containing the patch content.</li>
                <li><code>target</code>: (Required) The destination file to patch.</li>
                <li><code>type</code>: (Required) The patching strategy. Currently, only `JsonMerge` is supported, which performs a deep merge of the source JSON into the target JSON.</li>
            </ul>
            <pre><code>[[patch]]
type = "JsonMerge"
source = "vscode_settings.json"
target = "~/.vscode-server/data/Machine/settings.json"
requires = ["user=vscode"]</code></pre>


            <h3><code>[[install]]</code></h3>
            <p>Installs tools or packages. Can be a script or use the built-in Universal Binary Installer (`ubi`).</p>
             <ul>
                <li><code>name</code>: (Required) A unique name for the installation.</li>
                <li><code>source</code>: (Required) The name of the installer defined in the `[sources]` table (e.g., `apt`, `brew`) or `ubi` for the universal installer.</li>
                <li><code>check_cmd</code>: (Optional) A shell command. If it returns a zero exit code, the installation is skipped. Useful for checking if a tool is already installed.</li>
                <li><code>post_install_cmd</code>: (Optional) A shell command to run after a successful installation.</li>
                <li><code>[install.variables]</code>: A table of key-value pairs to be used in templating for the source script or `ubi` installer.</li>
            </ul>
            <pre><code># Using a custom source
[[install]]
name = "ripgrep"
source = "apt"
check_cmd = "command -v rg"

# Using the UBI
[[install]]
name = "fish"
source = "ubi"
check_cmd = "command -v fish"
requires = ["+arch=aarch64", "+os=linux"]

[install.variables]
exe = "fish"
url = "https://github.com/fish-shell/fish-shell/releases/download/4.0.2/fish-static-aarch64-4.0.2.tar.xz"
</code></pre>

            <h3><code>[sources]</code></h3>
            <p>Defines reusable, templated installer scripts. Uses Handlebars for templating based on variables from the `[[install]]` section.</p>
            <pre><code>[sources]
apt = """
#!/bin/bash
[ "$(find /var/lib/apt/lists -type f -mmin +720)" ] && sudo apt-get update
sudo apt-get install -y --no-install-recommends {{ name }}
"""
brew = "brew install {{ name }}"</code></pre>

            <h3><code>[profiles]</code></h3>
            <p>Defines profiles, which are named collections of tags. Running HermitGrab with a profile activates all of its tags.</p>
            <pre><code>[profiles]
default = ["fish"]
work-rust = ["fish", "git", "rust", "starship"]</code></pre>
        </div>
    </main>
    <script>
        lucide.createIcons();
    </script>
</body>
</html>
